
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Generic tools &#8212; ADCPy  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Nortek Signature tools" href="Nortekstuff.html" />
    <link rel="prev" title="Welcome to ADCPy’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-EPICstuff.reshapeEPIC">
<span id="generic-tools"></span><h1>Generic tools<a class="headerlink" href="#module-EPICstuff.reshapeEPIC" title="Permalink to this headline">¶</a></h1>
<div class="section" id="reshapeepic">
<h2>reshapeEPIC<a class="headerlink" href="#reshapeepic" title="Permalink to this headline">¶</a></h2>
<p>apportion a continuous time series file into bursts (e.g. reshape)</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>the expected dimensions are [time, depth, lat, lon] for continuous data in EPIC</p></li>
<li><p>we are reshaping to [time, sample, depth, lat, lon]</p></li>
<li><p>for ADCP files, beams are expressed as variables vel1, vel2, … veln</p></li>
<li><p>if there is a shape problem then the data file might not be properly understood.</p></li>
</ul>
<p>It might be that this code won’t work, this problem will become evident if an error is produced and operation
returns to the keyboard in debug mode.  If this happens, check the shapes of the variables.</p>
<p>WARNING:  time may not be monotonically increasing within bursts (e.g. along the sample dimension)
this means that if the number of samples per burst is inconsistent, or if
there are gaps in time, the end of a burst may be fill_value, including time values</p>
<p>Marinna Martini for the USGS in Woods Hole, 9/20/2018
originally coded for MATLAB as reshapeEPIC
<a class="reference external" href="https://cmgsoft.repositoryhosting.com/trac/cmgsoft_m-cmg/browser/trunk/MMstuff/reshapeEPIC.m">https://cmgsoft.repositoryhosting.com/trac/cmgsoft_m-cmg/browser/trunk/MMstuff/reshapeEPIC.m</a></p>
<p>Created on Thu Sep 20 14:52:42 2018</p>
<p>&#64;author: mmartini
<a class="reference external" href="https://github.com/mmartini-usgs">https://github.com/mmartini-usgs</a></p>
<dl class="function">
<dt id="EPICstuff.reshapeEPIC.find_boundaries">
<code class="sig-prename descclassname">EPICstuff.reshapeEPIC.</code><code class="sig-name descname">find_boundaries</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">edges</em><span class="sig-paren">)</span><a class="headerlink" href="#EPICstuff.reshapeEPIC.find_boundaries" title="Permalink to this definition">¶</a></dt>
<dd><p>using a list of start and end timestamps (edges) that delineate the beginning times and ending times
of burts of measurements, find the indices into the data that correspond to these edges.
The time base may be irregular, it does not matter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list</em>) – time stamps from the data</p></li>
<li><p><strong>edges</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em>) – start and end times</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of indices</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="EPICstuff.reshapeEPIC.find_first_masked_value">
<code class="sig-prename descclassname">EPICstuff.reshapeEPIC.</code><code class="sig-name descname">find_first_masked_value</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#EPICstuff.reshapeEPIC.find_first_masked_value" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to find the first occurrence of a masked value in a numpy masked array
returns None if no masked values are found
:param numpy array x:
:return: index</p>
</dd></dl>

<dl class="function">
<dt id="EPICstuff.reshapeEPIC.generate_expected_start_times">
<code class="sig-prename descclassname">EPICstuff.reshapeEPIC.</code><code class="sig-name descname">generate_expected_start_times</code><span class="sig-paren">(</span><em class="sig-param">cdffile</em>, <em class="sig-param">dim</em>, <em class="sig-param">burst_start_offset</em>, <em class="sig-param">burst_interval</em>, <em class="sig-param">burst_length</em>, <em class="sig-param">sample_rate</em><span class="sig-paren">)</span><a class="headerlink" href="#EPICstuff.reshapeEPIC.generate_expected_start_times" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a regular and recurring set of start and end timestamps that
delineate the beginning times and ending times of burts of measurements</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cdffile</strong> (<em>str</em>) – name of a continuous time series data file</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – the unlimited or time dimension which we will find the indices to reshape</p></li>
<li><p><strong>burst_start_offset</strong> (<em>int</em>) – when to start to make bursts in the continuous data, seconds</p></li>
<li><p><strong>burst_interval</strong> (<em>int</em>) – time between start of bursts, seconds</p></li>
<li><p><strong>burst_length</strong> (<em>int</em>) – number of samples in a burst</p></li>
<li><p><strong>sample_rate</strong> (<em>int</em>) – Hertz</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of tuples of start and end times for each burst</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="EPICstuff.reshapeEPIC.reshapeEPIC">
<code class="sig-prename descclassname">EPICstuff.reshapeEPIC.</code><code class="sig-name descname">reshapeEPIC</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#EPICstuff.reshapeEPIC.reshapeEPIC" title="Permalink to this definition">¶</a></dt>
<dd><p>apportion a continuous time series file into bursts (e.g. reshape)</p>
<dl class="field-list simple">
<dt class="field-odd">Usage</dt>
<dd class="field-odd"><p>issue_flags = reshapeEPIC(cont_file, burst_file, burst_length,
dim=None, edges=None, drop=None)</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>cont_file</strong> (<em>str</em>) – name of netCDF file with continuous data</p></li>
<li><p><strong>burst_file</strong> (<em>str</em>) – name of file to store the reshaped data, attributes will be copied</p></li>
<li><p><strong>burst_length</strong> (<em>int</em>) – maximum number of samples in each burst</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – name of dimension along which we will split the data, usually ‘time’ or ‘Rec’</p></li>
<li><p><strong>edges</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em>) – [(start0, end0), (start1, end1), …] of edges defining the edges of each burst</p></li>
<li><p><strong>drop</strong> (<em>str</em>) – set of variable names to omit from the output file</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary of problem types and status</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="EPICstuff.reshapeEPIC.save_indexes_to_file">
<code class="sig-prename descclassname">EPICstuff.reshapeEPIC.</code><code class="sig-name descname">save_indexes_to_file</code><span class="sig-paren">(</span><em class="sig-param">cdffile</em>, <em class="sig-param">txtfile</em>, <em class="sig-param">edge_tuples</em><span class="sig-paren">)</span><a class="headerlink" href="#EPICstuff.reshapeEPIC.save_indexes_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write indexes to a file with the time stamps for QA/QC</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cdffile</strong> (<em>str</em>) – the continuous time series netCDF file being operated upon</p></li>
<li><p><strong>txtfile</strong> (<em>str</em>) – a file to output a string listing of time stamps</p></li>
<li><p><strong>edge_tuples</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em>) – the bursts to output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ADCPy</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Generic tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#reshapeepic">reshapeEPIC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Nortekstuff.html">Nortek Signature tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="TRDIstuff.html">TRDI ADCP tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing ADCPy</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to ADCPy’s documentation!</a></li>
      <li>Next: <a href="Nortekstuff.html" title="next chapter">Nortek Signature tools</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Marinna Martini.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/EPICstuff.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>